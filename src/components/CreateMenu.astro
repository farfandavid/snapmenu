---
import Button from "./Button.astro";
---

<div class="flex flex-col items-center">
    <h1 class="font-bold text-2xl">Welcome to SnapMenu</h1>
    <p class="text-xl">Let's start by creating a Menu</p>
    <div
        class="flex roundedflex flex-col justify-between bg-white rounded-lg shadow-lg p-6 fade-in-right"
    >
        <h1 class="font-bold text-lg">
            Let's choose the name of your restaurant or business.
        </h1>
        <p>This will also be the name of your menu page</p>
        <form action="api/menu/create" method="POST" id="form-menu">
            <input
                type="text"
                name="menuName"
                placeholder="Menu Name"
                autocomplete="off"
                required
                class="rounded-lg p-2 border border-gray-300 w-full mt-2 mb-2"
            />
            <input
                type="text"
                name="description"
                placeholder="Description"
                autocomplete="off"
                required
                class="rounded-lg p-2 border border-gray-300 w-full mt-2 mb-2"
                maxlength="60"
            />
            <Button type="submit" className=""> Create Menu </Button>
        </form>
    </div>
</div>
<script is:inline>
    const form = document.getElementById("form-menu");

    form.addEventListener("submit", async (e) => {
        e.preventDefault();
        const formData = new FormData(form);
        const menuName = formData.get("menuName");
        const description = formData.get("description");
        const response = await fetch("/api/menu/create", {
            method: "POST",
            body: JSON.stringify({ name: menuName, description }),
            headers: {
                "Content-Type": "application/json",
            },
        });
        const data = await response.json();
        console.log(data);
        if (data.error) {
            alert(data.error);
        }
        if (data.name) {
            alert(`Menu ${data.name} created successfully`);
            window.location.reload();
        }
    });
</script>
